<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Students - EduManage</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .icon { display:inline-block; vertical-align:middle }
    .icon svg { display:block }
  </style>
</head>
<body class="bg-blue-50 min-h-screen text-slate-800">
  <div id="mobile-overlay" class="hidden lg:hidden fixed inset-0 bg-black bg-opacity-50 z-30"></div>

  <!-- Sidebar -->
  <aside id="app-sidebar" class="fixed inset-y-0 left-0 z-50 w-64 bg-white border-r border-slate-200 transform transition-transform duration-300 ease-in-out -translate-x-full lg:translate-x-0">
    <div class="flex flex-col h-full">
      <!-- Header -->
      <div class="py-3 px-6 border-b border-slate-200">
        <h2 class="text-xl font-bold text-blue-600">EduManage</h2>
        <p class="text-sm text-slate-500 mt-0.5">Teacher Portal</p>
      </div>
      
      <!-- Navigation -->
      <nav id="sidebar-nav" class="flex-1 p-4 space-y-1">
        <a href="dashboard.html" data-path="dashboard.html" class="w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors duration-200 text-slate-700 hover:bg-slate-50">
          <span class="icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="8" rx="1" ry="1"/><rect x="14" y="3" width="7" height="5" rx="1" ry="1"/><rect x="14" y="12" width="7" height="9" rx="1" ry="1"/><rect x="3" y="12" width="7" height="9" rx="1" ry="1"/></svg></span>
          <span class="font-medium">Dashboard</span>
        </a>
        <a href="schedule.html" data-path="schedule.html" class="w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors duration-200 text-slate-700 hover:bg-slate-50">
          <span class="icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg></span>
          <span class="font-medium">Schedule</span>
        </a>
        <a href="students.html" data-path="students.html" class="w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors duration-200 text-slate-700 hover:bg-slate-50">
          <span class="icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg></span>
          <span class="font-medium">Students</span>
        </a>
        <a href="courses.html" data-path="courses.html" class="w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors duration-200 text-slate-700 hover:bg-slate-50">
          <span class="icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20V6a2 2 0 0 0-2-2H6.5A2.5 2.5 0 0 0 4 6.5V19.5z"/><path d="M20 4v16"/></svg></span>
          <span class="font-medium">Courses</span>
        </a>
        <a href="settings.html" data-path="settings.html" class="w-full flex items-center space-x-3 px-4 py-3 rounded-lg transition-colors duration-200 text-slate-700 hover:bg-slate-50">
          <span class="icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09c.15.7.66 1.25 1.36 1.36h.09a1.65 1.65 0 0 0 1.51 1 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9c.7.15 1.25.66 1.36 1.36V10a2 2 0 0 1 0 4h-.09c-.7.15-1.25.66-1.36 1.36z"/></svg></span>
          <span class="font-medium">Settings</span>
        </a>
      </nav>

      <div class="p-4 border-t border-slate-200 mt-auto">
        <button id="logout-btn" class="w-full flex items-center space-x-3 px-4 py-2 text-slate-600 hover:bg-red-100 rounded-lg transition-colors border border-slate-200 bg-white">
          <span class="icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><polyline points="21 12 9 12"/></svg></span>
          <span>Logout</span>
        </button>
      </div>
    </div>
  </aside>

  <!-- Main -->
  <div class="p-4 md:p-6 max-w-7xl mx-auto lg:ml-64">
    <div class="mb-8">
      <div class="bg-white p-4 sm:p-6 rounded-lg shadow-sm border border-slate-100 overflow-x-hidden relative">
        <div class="flex items-center justify-between gap-6 flex-wrap">
          <div class="flex items-center gap-4 min-w-0">
            <button id="mobile-menu-btn" class="lg:hidden inline-flex items-center p-2 bg-white rounded-lg shadow-md mr-2"> <span id="mobile-icon">☰</span></button>
            <div id="admin-avatar" class="w-12 h-12 bg-white rounded-full flex items-center justify-center text-blue-700 font-bold text-lg ring-1 ring-slate-100 shadow-sm border border-slate-200">JD</div>
            <div>
              <h1 class="text-2xl font-extrabold text-slate-900 leading-tight">Students</h1>
              <p class="text-sm text-slate-500 mt-1">Manage and view all your students — quick access to profiles and attendance.</p>
            </div>
          </div>

          <div class="flex items-center gap-4">
            <div class="hidden sm:flex items-center gap-3">
              <div class="bg-white rounded-lg shadow border border-slate-100 text-center min-w-[96px] h-12 flex flex-col justify-center px-3">
                <div class="text-xs text-slate-600">Total Students</div>
                <div id="header-total-students" class="text-lg font-semibold text-slate-900">6</div>
              </div>
              <div class="bg-white rounded-lg shadow border border-slate-100 text-center min-w-[96px] h-12 flex flex-col justify-center px-3">
                <div class="text-xs text-slate-600">Avg Attendance</div>
                <div id="header-avg-att" class="text-lg font-semibold text-blue-600">92%</div>
              </div>
            </div>

            <button id="students-notif" class="relative inline-flex items-center p-2 rounded-md hover:bg-slate-50 bg-white border border-slate-100">
              <span class="icon text-slate-700"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 17h5l-1.405-1.405A2.032 2.032 0 0 1 18 14.158V11a6 6 0 1 0-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg></span>
              <span id="students-notif-badge" class="absolute -top-1 -right-1 bg-rose-500 text-white text-xs rounded-full px-1.5 py-0.5">2</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Search & Actions -->
    <div class="flex flex-col sm:flex-row gap-4 mb-6">
      <div class="flex-1 relative">
        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="7"/><path d="M21 21l-4.35-4.35"/></svg></span>
        <input id="search" type="text" placeholder="Search students by name or class..." class="w-full pl-10 pr-4 py-3 border border-slate-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition" />
      </div>
      <button id="addStudent" class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-6 py-3 rounded-lg transition-colors flex items-center justify-center space-x-2">
        <span class="icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14M5 12h14"/></svg></span>
        <span>Add Student</span>
      </button>
    </div>

    <!-- Students table -->
    <div class="bg-white rounded-lg shadow-sm border border-slate-100 overflow-x-auto">
      <table class="min-w-full divide-y divide-slate-100">
        <thead class="bg-slate-50">
          <tr>
            <th class="px-4 py-3 text-left text-sm font-medium text-slate-600">Student</th>
            <th class="px-4 py-3 text-left text-sm font-medium text-slate-600">Class</th>
            <th class="px-4 py-3 text-left text-sm font-medium text-slate-600">Email</th>
            <th class="px-4 py-3 text-left text-sm font-medium text-slate-600">Phone</th>
            <th class="px-4 py-3 text-left text-sm font-medium text-slate-600">Attendance</th>
            <th class="px-4 py-3 text-right text-sm font-medium text-slate-600">Actions</th>
          </tr>
        </thead>
        <tbody id="studentsTableBody" class="bg-white divide-y divide-slate-100"></tbody>
      </table>
    </div>
  </div>

  <!-- Delete confirmation modal -->
  <div id="deleteModalOverlay" class="hidden fixed inset-0 bg-black bg-opacity-40 z-50 flex items-center justify-center">
    <div id="deleteModal" class="bg-white rounded-lg shadow-lg w-full max-w-md mx-4">
      <div class="p-6">
        <h3 class="text-lg font-semibold text-slate-900">Delete student</h3>
        <p id="deleteModalMessage" class="text-sm text-slate-600 mt-2">Are you sure you want to delete this student?</p>
        <div class="mt-6 flex items-center justify-end gap-3">
          <button id="deleteCancel" class="px-4 py-2 rounded-md border border-slate-200 bg-white text-slate-700 hover:bg-slate-50">Cancel</button>
          <button id="deleteConfirm" class="px-4 py-2 rounded-md bg-rose-600 text-white hover:bg-rose-700">Delete</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // static students data (kept client-side for search/filter only)
    const students = [
      { id:1, name:'Alice Johnson', email:'alice.johnson@school.edu', phone:'+1 (555) 123-4567', class:'Grade 10A', attendance:95, avatar:'AJ' },
      { id:2, name:'Bob Smith', email:'bob.smith@school.edu', phone:'+1 (555) 234-5678', class:'Grade 10A', attendance:88, avatar:'BS' },
      { id:3, name:'Carol White', email:'carol.white@school.edu', phone:'+1 (555) 345-6789', class:'Grade 10A', attendance:92, avatar:'CW' },
      { id:4, name:'David Brown', email:'david.brown@school.edu', phone:'+1 (555) 456-7890', class:'Grade 10B', attendance:90, avatar:'DB' },
      { id:5, name:'Emma Davis', email:'emma.davis@school.edu', phone:'+1 (555) 567-8901', class:'Grade 10B', attendance:97, avatar:'ED' },
      { id:6, name:'Frank Miller', email:'frank.miller@school.edu', phone:'+1 (555) 678-9012', class:'Grade 11A', attendance:85, avatar:'FM' }
    ];

    function escapeHtml(s){ return String(s).replace(/[&<>\"']/g, c=> ({'&':'&amp;','<':'&lt;','>':'&gt;','\"':'&quot;',"'":'&#39;'})[c]); }

    function renderStudents(filter=''){
      const tbody = document.getElementById('studentsTableBody');
      const q = (filter||'').toLowerCase().trim();
      const list = students.filter(s => s.name.toLowerCase().includes(q) || s.class.toLowerCase().includes(q));
      // update header stats to reflect visible list
      const totalEl = document.getElementById('header-total-students');
      const avgEl = document.getElementById('header-avg-att');
      if(totalEl) totalEl.textContent = list.length;
      if(avgEl){ const avg = list.length ? Math.round(list.reduce((a,b)=>a+b.attendance,0)/list.length) : 0; avgEl.textContent = avg + '%'; }
      if(!tbody) return;
      if(list.length===0){ tbody.innerHTML = '<tr><td colspan="6" class="text-center text-slate-500 py-8">No students found.</td></tr>'; return; }
      tbody.innerHTML = list.map(s => `
        <tr class="hover:bg-slate-50">
          <td class="px-4 py-4">
            <div class="flex items-center gap-3">
              <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-700 font-semibold">${escapeHtml(s.avatar)}</div>
              <div>
                <div class="font-semibold text-slate-900">${escapeHtml(s.name)}</div>
              </div>
            </div>
          </td>
          <td class="px-4 py-4 text-sm text-slate-600">${escapeHtml(s.class)}</td>
          <td class="px-4 py-4 text-sm text-slate-600 truncate max-w-[220px]">${escapeHtml(s.email)}</td>
          <td class="px-4 py-4 text-sm text-slate-600">${escapeHtml(s.phone)}</td>
          <td class="px-4 py-4">
            <div class="text-sm text-slate-600 mb-1">${s.attendance}%</div>
            <div class="w-full bg-slate-200 rounded-full h-2"><div class="bg-blue-600 h-2 rounded-full" style="width:${s.attendance}%"></div></div>
          </td>
          <td class="px-4 py-4 text-right">
            <button class="text-slate-500 hover:text-slate-800 p-2 rounded-md" title="View">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M21 21l-4.35-4.35"/></svg>
            </button>
            <button type="button" data-id="${s.id}" data-name="${escapeHtml(s.name)}" class="ml-2 text-rose-600 hover:text-rose-700 p-2 rounded-md remove-btn" title="Remove">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6M14 11v6"/></svg>
            </button>
          </td>
        </tr>
      `).join('');
    }

    // wire search
    document.getElementById('search').addEventListener('input', (e)=> renderStudents(e.target.value));

    // sidebar functionality (minimal)
    (function setupSidebar(){
      const btn = document.getElementById('mobile-menu-btn');
      const overlay = document.getElementById('mobile-overlay');
      const aside = document.getElementById('app-sidebar');
      const mobileIcon = document.getElementById('mobile-icon');
      let isOpen = false;
      function setOpen(open){ isOpen = open; if (isOpen){ aside.classList.remove('-translate-x-full'); overlay.classList.remove('hidden'); if(mobileIcon) mobileIcon.textContent='✕'; } else { aside.classList.add('-translate-x-full'); overlay.classList.add('hidden'); if(mobileIcon) mobileIcon.textContent='☰'; } }
      if(btn) btn.addEventListener('click', ()=> setOpen(!isOpen));
      if(overlay) overlay.addEventListener('click', ()=> setOpen(false));
      const nav = document.getElementById('sidebar-nav'); function updateActive(){ if(!nav) return; const currentFile = (location.pathname.split('/').pop() || '').toLowerCase(); nav.querySelectorAll('[data-path]').forEach(a=>{ a.classList.remove('bg-blue-50','text-blue-700','text-slate-600'); a.removeAttribute('aria-current'); const path = (a.getAttribute('data-path') || a.getAttribute('href') || '').toLowerCase(); if(path === currentFile){ a.classList.add('bg-blue-50','text-blue-700'); a.setAttribute('aria-current','page'); } else { a.classList.add('text-slate-600'); } }); }
      if(nav) nav.querySelectorAll('[data-path]').forEach(a=> a.addEventListener('click', ()=>{ if(window.innerWidth<1024) setOpen(false); setTimeout(updateActive,100); }));
      updateActive();
    })();

    // populate admin avatar/name (placeholder)
    (function populateAdmin(){ const ADMIN_NAME = 'John Doe'; const avEl = document.getElementById('admin-avatar'); if(avEl) avEl.textContent = ADMIN_NAME.split(' ').map(s=>s[0]).join('').toUpperCase().slice(0,2); })();

    // Delete modal handling
    (function deleteModalSetup(){
      const overlay = document.getElementById('deleteModalOverlay');
      const modalMessage = document.getElementById('deleteModalMessage');
      const btnCancel = document.getElementById('deleteCancel');
      const btnConfirm = document.getElementById('deleteConfirm');
      let targetId = null;

      function openDeleteModal(id, name){ targetId = parseInt(id,10); if(modalMessage) modalMessage.textContent = 'Are you sure you want to delete ' + name + '? This action cannot be undone.'; if(overlay) overlay.classList.remove('hidden'); setTimeout(()=> { if(btnCancel) btnCancel.focus(); },50); }
      function closeDeleteModal(){ targetId = null; if(overlay) overlay.classList.add('hidden'); }

      if(btnCancel) btnCancel.addEventListener('click', closeDeleteModal);
      if(overlay) overlay.addEventListener('click', (e)=>{ if(e.target === overlay) closeDeleteModal(); });
      document.addEventListener('keydown', (e)=>{ if(e.key === 'Escape' && overlay && !overlay.classList.contains('hidden')) closeDeleteModal(); });

      if(btnConfirm) btnConfirm.addEventListener('click', ()=>{
        if(targetId==null) return closeDeleteModal();
        const idx = students.findIndex(s=>s.id === targetId);
        if(idx>-1){ students.splice(idx,1); }
        closeDeleteModal();
        const qInput = document.getElementById('search');
        renderStudents(qInput ? qInput.value : '');
      });

      // open modal when clicking any .remove-btn via delegation
      document.addEventListener('click', (e)=>{
        const el = e.target.closest ? e.target.closest('.remove-btn') : null;
        if(!el) return;
        const id = el.getAttribute('data-id');
        const name = el.getAttribute('data-name') || 'this student';
        openDeleteModal(id, name);
      });
    })();

    // initial render
    renderStudents();
  </script>
</body>
</html>
